# 动态路由

路由有很多配置方式，配置文件以及代码配置，但是存在一个共同问题：需要重启。

动态路由的原理：将路由信息存放在某个中间层，然后在项目启动后对这个文件进行加载和监听，

这个中间层可以是数据库或者文件，重要的是能在这个文件被修改后监听到这个文件的变化并重新加载。

### 实现ApplicationEventPublisherAware接口监听路由文件的变化并重新加载。

args的key是由org.springframework.cloud.gateway.support.NameUtils.generateName生成的

_genkey_0、_genkey_1可以自定义，没有限制，表示的是Path这个参数下的值。

http://localhost:20000/actuator/gateway/routes

````shell
curl --location 'http://localhost:20000/dynamic/route/info' \
--header 'Content-Type: application/json' \
--data '{
    "name":"张三"
}'
````

````yaml
[
  {
    "id": "dynamic_route",
    "uri": "lb://spring-cloud-gateway-service",
    "predicates": [
      {
        "name": "Path",
        "args": {
          "_genkey_0": "/dynamic/route/**"
        }
      }
    ],
    "filters":
      [
        {
          "name": "StripPrefix",
          "args": {
            "parts": "2"
          }
        }
      ]
  }
]
````